~p9d0g2FMw2z2x6l6
~FLW2Z2;
緣起		      基本想法
~FMW1Z1;
    由於職務的關係，常常要列印出各式	一．輸入部分：
的中文文件與表格。為求變化，便在其中
添加了許多中文系統的列印指令。最後雖	　　由螢幕取得使用者欲列印之檔名、紙
然得到一份漂亮的成果，卻常是以浪費了	張型式後，開啟該檔案，循序讀入字元。
不少紙張與時間所換來的。
　　在市面所售的一些排版軟體中，多具	二．處理部分：
有列印預視的功能，因而興起自己動手寫
一個簡易列印預視程式的念頭。　　　　	　　若為列印指令則分析後改變對應變數
　　　　　　　　　　　　　　　　	之值，若為資料字元則依據當時設定，計
					算對應位置。
~FLW2Z2;使用系統
~FMW1Z1;					三．輸出部分：
    IBM AT　相容個人電腦
    單色繪圖螢幕			　　利用中文系統提供之繪圖功能，模擬
    KC - DOS 5.0 版			 列印於螢幕限定之紙張上。
    倚天中文系統 3.00 版
    Turbo Pascal 5.0 版

~FLW2Z2;原理
~FMW1Z1;
一．紙張尺寸：

Ａ１、Ｂ１分別由Ａ０、Ｂ０對折而得，餘類推之。
Ｃ則代表常用以"開"計量之紙型，如：Ｃ０＝全開、Ｃ３＝八開...。
    Ａ０紙之實際尺寸為　118.9 cm x 84.1 cm (面積為 1平方公尺)，
    Ｂ０紙之實際尺寸為　141.4 cm x 100 cm  (面積為 1.414平方公尺)，
為了程式計算方便，以 1／360 吋為一單位，則：
    Ａ０紙之尺寸為　16855 x 11918 平方單位，
    Ｂ０紙之尺寸為　20044 x 14173 平方單位，
    Ｃ０紙之尺寸為  15113 x 10864 平方單位。

二．字符列印大小：

  １．指令Ｐ及Ｄ決定密度。
  ２．指令ＴＷ決定構成一個字寬度之點數。
  ３．指令Ｘ決定字間之點數。
  ４．指令ＴＺ決定構成一個字高度之點數。
  ５．指令Ｌ決定行間之點數。

三．螢幕顯示：

　　螢幕中紙張固定以單張紙之直式或橫式顯示，並以一矩形代表一中文字或英文
字。
    　　　  螢幕顯示位置　	字符實際位置
    利用　──────── ＝ ────────	取得該矩形之坐標值
	    螢幕紙張點數	紙張實際尺寸

~FLW2Z2;程式流程
~FMW1Z1X3l0;
			       ╭───╮
			       │ 開始 │
			       ╰─┬─╯
				   ↓
				   ︿	   N
			     ＜ 已進中文 ＞────────────┐
				   ﹀				   │
				   │Y				   │
				   ↓				   │
		       ┌───────────┐		   │
		       │ 設定中文系統操作參數 │		   │
		       └─────┬─────┘		   │
				   ↓				   │
		 ┌─────────────────┐ 	   │
		 │輸入檔名、紙張型式、預留邊界並顯示│ 	   │
		 └────────┬────────┘ 	   │
				   ↓				   │
				   ︿	   Y			   │
			     ＜ 空白檔名 ＞───────────→│
				   ﹀				   │
				   │N				   │
				   ↓				   │
		       ┌───────────┐		   │
		       │設定真實及螢幕紙張尺寸│		   │
		       └─────┬─────┘		   │
				   ↓				   │
       ┌─────┐	 ┌─────────┐ 		   │
       │ 等待按鍵 ├─→│賦予變數新頁起始值│ 		   │
       └─────┘	 └────┬────┘ 		   │
	     ↑Y		   ↓				   │
	     ︿      N		   ︿	   Y	 ┌───────┐↓  ╭───╮
       ＜ 印至頁末 ＞───→＜ 檔案末端 ＞──→│ 恢復原來狀態 ├─→│ 結束 │
	     ﹀　	       或按下 Esc	 └───────┘    ╰───╯
	     ↑ 		   ﹀
	     │ 		   │N
	     │ 		   ↓
       ┌──┴──┐	 ┌─────────┐
       │ 列印新行 │	 │賦予變數新行起始值│
       └─────┘	 └────┬────┘
	     ↑ 		   ↓←────────────────────────┐
	     │ 	    Y	   ︿						       │
	     │←──────＜ 字高改變 ＞					       │
	     │ 		  N﹀　 					       │
	     │ 		   ↓						       │
       ┌──┴──┐	    Y	   ︿						       │
       │ 讀取新行 │←───＜ 一行末端 ＞					       │
       └─────┘		  N﹀						       │
				   ↓	     ┌─────┐			       │
			   ┌───────┐│  ┌───┴───┐		       │
			   │ 讀取一個字元 ││  │ 分析列印指令 │		       │
			   └───┬───┘│  └───────┘		       │
				   ↓	     │ 	 ↑			       │
			   Y	   ︿	     │  ┌───┴───┐		       │
		       ┌─ ＜進入中文字內＞ │  │ 讀取一個字元 │		       │
		       │	   ﹀	     │  └───────┘		       │
		       │	  N↓	     │ 	 ↑N			       │
		       │	   ︿	   Y ↓ 	 ︿	Y  ┌───────┐  │
		       │   ＜ASCII值=126＞───→＜ 指令結束 ＞→│ 重定字符尺寸 ├→│
		       │	   ﹀			 ﹀	   └───────┘  │
		       │	   ↓N						       │
		       │	   ︿	   Y   ┌────────┐		       │
		       │   ＜ASCII值>127＞─→│設定進入中文字內├─────────→│
		       │	   ﹀	       └────────┘		       │
		       │	   ↓N		     ︿      N	   ┌────┐        │
		       └───────────＜ 超出右緣 ＞──→│印出字符├───→│
						     ﹀ 	   └────┘        │
						     │Y			       │
						     └────────────────┘

~FLW2Z2X6l16;自定識別字摘要
~FMW1Z1;
MaxDot	   : 印表機最大密度		Density    : 列印密度
Max	   : 螢幕最大坐標		PreComNum  : 原始列印參數值
Side	   : 進紙方向			OldDot	   : 矩形左上角坐標
Paper	   : 實際紙張尺寸		CharSize   : 矩形尺寸
Margin	   : 實際紙張邊界		DotRatio   : 最大與現設密度比
BoxSize    : 螢幕紙張尺寸		InChinese  : 是否為中文字
SideBase   : 螢幕紙張左上角坐標 	CharLine   : 是否該行有資料字元
ShowSite   : 訊息顯示位置		OutOfLine  : 是否超出紙張寬度
CursorXY   : 游標停留坐標		HighChange : 是否中途改變高度
Dot	   : 矩形右下角坐標
PaperToBox : 實際與螢幕紙張尺寸比	ComNum	   : 列印參數值
OutOfRight : 是否超出紙張右緣		CharNum    : 字元在該行位置
					BetweenX   : 矩形間點數
ZeroForm   : ０號紙張實際尺寸
PaperNum   : 紙張號數			SpaceChar  : 是否為空白字
					TabNum	   : 空白壓縮數目
~FLW2Z2;
檢討		      操作方式
~FMW1Z1;
一．因利用中文系統提供之繪圖指令，而	一．進入中文系統後，執行本程式。
　　降低了程式可攜性，欲使用Pascal繪	　　例：C:\>PREVIEW [檔名]
　　圖函數，則需修改其繪圖界面。
					二．輸入欲列印之普通文字檔所在路徑及
二．只提供標準單張紙型式，且字符均以	　　完整檔名。直接按<Enter> 則跳離。
　　矩形代表，無法模擬真實列印情況。
					三．輸入使用之單張紙型式及進紙方向。
三．只支援兩組Ｐ與Ｄ之密度表，Ｉ、Ｔ	    (報表紙可用Ａ４-Ｌ或Ａ３-Ｗ模擬)
　　、Ｗ、Ｚ、Ｘ、Ｌ、Ｈ、Ｖ以外的指
    令並無作用。且對Ｚ值變化須換行的	四．設定列印時邊界，須以印表機上之欄
    規定，不若中文系統嚴格。		    位刻度為輸入單位。

四．程式未發展為常駐型式。		五．若字符位置超出紙張右緣則不顯示，
					    但執行完畢時有警告訊息。

					六．按<Esc> 即可離開。

